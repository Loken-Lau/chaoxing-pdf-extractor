# 学习通课程PDF提取工具 (Chaoxing PDF Extractor)

这是一个自动化脚本，用于从学习通（Chaoxing）课程页面提取章节内容（PPT、文档图片）并保存为PDF文件。

## ✨ 功能特点

- **多浏览器支持**：支持 **Microsoft Edge** (默认) 和 **Google Chrome**。
- **自动遍历章节**：只需提供课程首页链接，脚本会自动解析侧边栏，获取所有章节链接。
- **智能目录管理**：自动识别课程名称，创建独立的课程文件夹，并按章节结构归档PDF。
- **支持手动登录**：脚本启动后会打开浏览器，允许你手动扫码或输入账号登录，无需复杂的Cookie抓取。
- **自动提取图片**：自动识别页面中的PPT/文档图片，并将其拼接为PDF。
- **智能处理Iframe**：自动处理学习通复杂的嵌套Iframe结构。
- **详细日志**：清晰的进度提示，包括透明通道图片检测提示。

## 🛠️ 环境要求

- Windows / Mac / Linux
- Python 3.8+
- 浏览器：Microsoft Edge 或 Google Chrome

## 📦 安装步骤

1.  **克隆或下载本项目**到本地。

2.  **安装依赖库**：
    在终端中运行以下命令安装所需的Python库：
    ```bash
    pip install -r requirements.txt
    ```

3.  **准备浏览器驱动**：
    *   **Chrome 用户**：脚本内置了自动下载驱动功能，通常无需手动操作。如果网络受限，请手动下载 `chromedriver.exe` 并放入脚本目录。
    *   **Edge 用户**：脚本会尝试直接调用系统安装的 Edge。如果失败，请下载对应的 `msedgedriver.exe` 并放入脚本目录。

## 🚀 使用方法

1.  **配置目标课程**：
    打开 `main.py`，找到 `TARGET_COURSE_URL` 变量，将其修改为你想要下载的课程页面链接（通常是包含章节列表的页面）。

2.  **运行脚本**：
    ```bash
    python main.py
    ```

3.  **选择浏览器**：
    脚本启动后会提示选择浏览器：
    ```text
    请选择浏览器:
    1. Edge (默认)
    2. Chrome
    ```
    输入数字并回车。

4.  **手动登录**：
    - 浏览器启动后会自动打开学习通登录页。
    - 请在浏览器中完成登录（建议使用手机号验证码或扫码登录）。
    - **登录成功并看到课程章节列表页面后**，回到终端窗口。

5.  **开始下载**：
    - 在终端窗口按 **回车键 (Enter)**。
    - 脚本将自动开始解析章节并下载PDF到 `downloads/课程名称/` 文件夹下。

## ⚠️ 注意事项

- **下载速度**：为了防止被封禁，脚本在页面跳转时会有短暂延时。
- **内容类型**：目前主要支持提取以图片形式展示的PPT和文档。视频章节可能会被跳过或仅下载封面。
- **透明通道提示**：如果看到 "Image contains an alpha channel" 的提示，这是正常现象，脚本会自动处理并保留原图。

## 📝 常见问题

- **报错 `NoSuchWindowException`**：请不要在脚本运行过程中手动关闭浏览器窗口。
- **报错 `Unable to obtain driver`**：请检查网络连接，或手动下载对应的浏览器驱动放到脚本目录下。

## 📄 License

MIT License
